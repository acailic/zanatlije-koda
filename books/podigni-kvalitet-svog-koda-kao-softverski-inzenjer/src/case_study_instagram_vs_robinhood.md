# Studija slučaja: Instagram naspram Robinhooda

Vreme je za studiju slučaja. Hajde da pričamo o Android kodnim bazama Instagrama i Robinhooda, na kojima sam intenzivno radio. Sjajan su primer koliko je kvalitet koda nijansiran. Da sam stil kodiranja iz Instagrama doneo u Robinhood, tim bi me s pravom mrzeo – taj kod bi bio loš. I obrnuto, robinhoodovski pristup bi bio katastrofa na Instagramu.

Počnimo od Instagrama. Ključni kontekst je baza korisnika: već tada je aplikacija imala blizu milijardu korisnika, a kad sam odlazio, aktivnih je bilo preko milijardu. Većina dolazi iz zemalja u razvoju, pre svega iz Indije i Brazila. Sama kodna baza je izuzetno „vanila“ – kao da ste upravo otvorili Android dokumentaciju: aktivnosti, XML layouti, osnovni alati. Spoljnih biblioteka skoro da nema, sve je interno. Zbog toga je kod obiman, ali brutalno optimizovan, neverovatno brz i stabilan. Postoje čitavi timovi koji se bave isključivo performansama.

Android ekosistem otežava stvari: za razliku od iOS-a, ne možete da računamo da je 80–90% korisnika na dve najnovije verzije sistema. Situacija se popravlja, ali Instagram je u vreme kada sam radio morao da podržava desetak velikih verzija unazad. Kada vam je korisnička baza uglavnom na jeftinim telefonima od 70, 100 ili 150 dolara, sa malo RAM-a i starim OS-om, prioriteti postaju jasni: binarna veličina i performanse, naročito latencija. Spoljne biblioteke skoro uvek uvećavaju binarni fajl i uvode dodatna pozivanja funkcija, što znači usporavanje. Na sporom hardveru svaki milisekund se računa. Zato je Instagramova kodna baza jedinstvena, ali to ima smisla: na tom obimu morate da se držite proverene tehnologije i sami pišete optimizovan kod.

Sad pogledajmo Robinhood. Oko deset miliona korisnika, mahom u Sjedinjenim Državama – dakle u veoma bogatom tržištu sa solidnim telefonima. Kad sam se priključio, kompanija je još bila pre IPO-a, praktično startap, a startapi vole da rizikuju i eksperimentišu. Stoga je stil kodiranja bio potpuna suprotnost Instagramu: ultramoderno, sa svim aktuelnim bibliotekama – RxJava, Dagger 2, danas i Jetpack Compose. Kod je izuzetno sažet: biblioteke postoje upravo da umesto 150 linija vlastitog koda pozovete jednu metodu i završite posao.

Korisnici imaju odlične telefone i skoro svi su na novim verzijama Androida, pa ne morate da pišete beskrajne `if` grane za stare API-je. Kao startap, Robinhood je želeo da gura granice: to je i adut pri zapošljavanju – „kod nas radite sa najnovijim alatima“. Zbog toga je prelazak iz jedne firme u drugu bio kulturološki šok, ali iz opravdanih razloga. Nema smisla prepisivati instagramovski stil u Robinhood ili obrnuto. Na Instagramu sam često dočekivao ljude iz kompanija poput Airbnb-a, Ubera ili samog Robinhooda, koji bi pitali: „Gde vam je dependency injection? Gde su vam moderni alati?“ I svaki put sam morao da ispričam ovu priču: sve se vrti oko krajnjeg korisnika. Tek kada to zaista udahnete punim plućima, moći ćete da donosite prave tehničke odluke.
